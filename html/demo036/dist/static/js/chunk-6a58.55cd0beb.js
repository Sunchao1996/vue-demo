(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6a58"],{EQpc:function(e,t,r){"use strict";r.r(t);var o=r("6ZY3"),a=r.n(o),s=r("XVEU"),n=r("Y+jS"),c=r("hrJr"),u={name:"RolesAdd",data:function(){var e=this;return{chooseResourceParent:!1,labelPosition:"right",getInfoF:!0,formData:{roleName:"",roleCode:"",roleStatus:0,resourcesIds:"",checkResourcesIds:[],oldRoleCode:""},formRules:{roleName:[{required:!0,message:"角色名称不能为空!"}],roleCode:[{required:!0,message:"角色代码不能为空!"},{validator:function(t,r,o){void 0!==e.formData.oldRoleCode&&r!==e.formData.oldRoleCode?Object(s.b)(r).then(function(e){!1===e.data?o(new Error("代码已经存在")):o()}).catch(function(e){o(new Error("校验失败~"))}):o()},trigger:"blur"}]},resourcesList:[],treeDefaultProps:{label:"resourceName",children:"children"}}},watch:{},created:function(){var e=this;Object(n.e)().then(function(t){e.resourcesList=t.data});var t=this.$route.params.id;Object(s.d)(t).then(function(t){e.formData=a()({},e.formData,t.data),e.formData.oldRoleCode=e.formData.roleCode,e.formData.checkResourcesIds=t.data.resourcesIds.split("@")}).catch(function(t){Object(c.Message)({type:"error",message:"获取数据错误~",duration:5e3}),e.getInfoF=!1})},methods:{goBack:function(){this.$router.go(-1)},submitForm:function(){var e=this;console.log("submit"),this.$refs.roleUpdateForm.validate(function(t){console.log(t),t&&e.getInfoF&&(e.formData.resourcesIds=e.formData.checkResourcesIds.join("@"),Object(s.f)(e.formData).then(function(){e.$router.replace({name:"Roles"})}).catch(function(e){console.log("更新角色失败")}))})},checkResource:function(e,t){this.formData.checkResourcesIds=t.checkedKeys,console.log(this.formData.checkResourcesIds)}}},l=(r("xq7r"),r("ZrdR")),d=Object(l.a)(u,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",[r("el-col",{attrs:{offset:6,span:12}},[r("el-form",{ref:"roleUpdateForm",attrs:{"label-position":e.labelPosition,"label-width":"100px",model:e.formData}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName",rules:e.formRules.roleName}},[r("el-input",{attrs:{disabled:!0},model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色代码",prop:"roleCode",rules:e.formRules.roleCode}},[r("el-input",{model:{value:e.formData.roleCode,callback:function(t){e.$set(e.formData,"roleCode",t)},expression:"formData.roleCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否启用"}},[r("el-col",{attrs:{span:20}},[r("el-radio",{attrs:{label:0},model:{value:e.formData.roleStatus,callback:function(t){e.$set(e.formData,"roleStatus",t)},expression:"formData.roleStatus"}},[e._v("启用")]),e._v(" "),r("el-radio",{attrs:{label:1},model:{value:e.formData.roleStatus,callback:function(t){e.$set(e.formData,"roleStatus",t)},expression:"formData.roleStatus"}},[e._v("禁用")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"角色资源"}},[r("el-tree",{attrs:{data:e.resourcesList,"show-checkbox":"","check-strictly":!0,"node-key":"id","default-expanded-keys":e.formData.checkResourcesIds,"default-checked-keys":e.formData.checkResourcesIds,props:e.treeDefaultProps},on:{check:e.checkResource}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("立即更新")]),e._v(" "),r("el-button",{on:{click:e.goBack}},[e._v("返回")])],1)],1)],1)],1)],1)},[],!1,null,"76b2f06f",null);d.options.__file="update.vue";t.default=d.exports},XVEU:function(e,t,r){"use strict";r.d(t,"e",function(){return a}),r.d(t,"a",function(){return s}),r.d(t,"b",function(){return n}),r.d(t,"c",function(){return c}),r.d(t,"d",function(){return u}),r.d(t,"f",function(){return l});var o=r("t3Un");function a(e){return Object(o.a)({url:"/sys/roles/list",method:"get",params:e})}function s(e){return Object(o.a)({url:"/sys/roles/add",method:"post",data:e})}function n(e){return Object(o.a)({url:"/sys/roles/checkRoleCode",method:"post",data:{roleCode:e}})}function c(e){return Object(o.a)({url:"/sys/roles/delete",method:"post",data:{roleId:e}})}function u(e){return Object(o.a)({url:"/sys/roles/get",method:"post",data:{roleId:e}})}function l(e){return Object(o.a)({url:"/sys/roles/update",method:"post",data:e})}},"Y+jS":function(e,t,r){"use strict";r.d(t,"e",function(){return a}),r.d(t,"b",function(){return s}),r.d(t,"a",function(){return n}),r.d(t,"c",function(){return c}),r.d(t,"d",function(){return u}),r.d(t,"f",function(){return l});var o=r("t3Un");function a(e){return Object(o.a)({url:"/sys/resources/list",method:"get",params:e})}function s(e){return Object(o.a)({url:"/sys/resources/checkCode",method:"get",params:e})}function n(e){return Object(o.a)({url:"/sys/resources/add",method:"post",data:e})}function c(e){return Object(o.a)({url:"/sys/resources/delete",method:"get",params:e})}function u(e){return Object(o.a)({url:"/sys/resources/getById",method:"get",params:e})}function l(e){return Object(o.a)({url:"/sys/resources/update",method:"post",data:e})}},dkPQ:function(e,t,r){},xq7r:function(e,t,r){"use strict";var o=r("dkPQ");r.n(o).a}}]);